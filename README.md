# Шаблон мониторинга СПО «Локальный модуль «Честный ЗНАК» через http агент Zabbix.

## Обзор

Шаблон для мониторинга основных параметров ЛМЧЗ без внешних скриптов.
Данные собираются из API /api/v1/status 

## Требования

Версия Zabbix: 7.0 и выше.

## Протестированные версии

Шаблон протестирован на версии ЛМЧЗ:
1.3.1-369

## Конфигурация

> Дополнительных действий не требуется.

## Установка

1\. Создать хост для каждого ЛМЧЗ

2\. Присоединить шаблон к хосту

3\. Заполнить значения макросов {$LMCZ_USER} и {$LMCZ_PWD} в шаблоне, если одинаковые для всех хостов. Если каждый хост со своим логином и паролем - добавить соответствующие макросы к хосту и заполнить значениями.



### Макросы

|Имя|Описание|Значение по умолчанию|
|----|-----------|-------|
|{$LMCZ_USER}|Логин к ЛМЧЗ|<p>-</p>|
|{$LMCZ_PWD}|Пароль к ЛМЧЗ|<p>-</p>|

### Элементы данных

|Имя|Описание|Тип|Ключ и дополнительная информация|
|----|-----------------------|-------|----------------|
|Данные /api/v1/status|<p>Возвращает JSON массив с исходными данными.</p>|HTTP агент|lmcz.getStatus |

### Триггеры

|Имя|Условия|Важность|Зависимости и дополнительная информация|
|----------------------|---------------------------|--------|----------|
|[ЛМЧЗ] Данные не синхронизировались более 1 суток|`last(/LMCZ by http agent/lmcz.lastSync)<(now()-86400)`|Предупреждение||
|[ЛМЧЗ] Некорректный статус ({ITEM.LASTVALUE})|`last(/LMCZ by http agent/lmcz.status)<>"ready"`|Высокая||
|[ЛМЧЗ] Некорректный тип режима обслуживания ({ITEM.LASTVALUE})|`last(/LMCZ by http agent/lmcz.operationMode)="service"`|Средняя||
|[ЛМЧЗ] Системе требуется загрузка БД|`last(/LMCZ by http agent/lmcz.requiresDownload)="true"`|Высокая||
